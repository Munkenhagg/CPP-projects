#!/data/data/com.termux/files/usr/bin/bash
set -euo pipefail

if [[ -z "${1:-}" ]]; then
    echo "Please provide a file"
    exit 1
fi

# Normalize name (strip any path the user passed)
INPUT="$1"
BASE="$(basename -- "$INPUT")"
NAMEALT="${BASE%.*}"

# Directory where this script lives
DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" &> /dev/null && pwd)"

CAND1="$DIR/$BASE"
CAND2="$DIR/${NAMEALT}_compiled"

# Prefer an executable with the exact name, else the _compiled one
if [[ -x "$CAND1" ]]; then
    exec "$CAND1" "${@:2}"
elif [[ -x "$CAND2" ]]; then
    exec "$CAND2" "${@:2}"
else
    echo "file does not exist or is not executable: '$CAND1' or '$CAND2'"
    exit 1
fi
